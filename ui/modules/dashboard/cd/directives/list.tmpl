<section ng-controller="cdAppCtrl">
	<tabset>
		<tab heading="Configuration" ng-click="getRecipe()">
			<br>
			<ngform></ngform>
		</tab>
		<tab heading="ledger {{updateCount}}" ng-click="getLedger()">
			<br />
			<div class="grid" ng-show="ledger && ledger.length > 0">
				<div class="table">
					<div ng-repeat="oneEntry in ledger" ng-class="{'first': $first, 'last': $last}" ng-class-odd="'odd'" ng-class-even="'even'" class="row w100 c-both">
						<div class="f-left">
							<span ng-if="oneEntry.update">
								Service <b>{{oneEntry.serviceName}}</b><b ng-if="oneEntry.serviceVersion">/Version{{oneEntry.serviceVersion}}</b> in Environment <b>{{oneEntry.env}}</b> was automatically update on <em>{{oneEntry.ts|fulldate}}</em> based on Continuous Delivery Strategy
							</span>
							
							<span ng-if="oneEntry.notify && !oneEntry.manual">
								New Update Received for service <b>{{oneEntry.serviceName}}</b><b ng-if="oneEntry.serviceVersion">/Version{{oneEntry.serviceVersion}}</b> in Environment <b>{{oneEntry.env}}</b> on <em>{{oneEntry.ts|fulldate}}</em> based on Continuous Delivery Strategy
							</span>
							
							<span ng-if="oneEntry.manual">
								Catalog was manually rebuilt for service <b>{{oneEntry.serviceName}}</b><b ng-if="oneEntry.serviceVersion">/Version{{oneEntry.serviceVersion}}</b> in Environment <b>{{oneEntry.env}}</b> on <em>{{oneEntry.ts|fulldate}}</em> by the administrator
							</span>
							
							<span ng-if="oneEntry.rebuild">
								Service <b>{{oneEntry.serviceName}}</b><b ng-if="oneEntry.serviceVersion">/Version{{oneEntry.serviceVersion}}</b> in Environment <b>{{oneEntry.env}}</b> was manually update on <em>{{oneEntry.ts|fulldate}}</em> by the administrator
							</span>
						</div>
						<div ng-if="oneEntry.notify && !oneEntry.manual" class="f-right">
							<div ng-show="oneEntry.image.prefix === 'soajsorg'" >
								<div ng-show="oneEntry.rms">
									<a class="btn btn-default" href="{{upgradeSpaceLink}}" target="_blank">Learn More</a>
								</div>
								<div ng-show="!oneEntry.rms">
									<a class="btn btn-default" href="" ng-click="updateEntry(oneEntry, 'redeploy');"><span class="icon icon-loop2"></span>&nbsp;Redeploy Service</a>
								</div>
							</div>
							<div ng-show="oneEntry.image.prefix !== 'soajsorg'" class="dropdown serviceOpsDropdown">
								<a class="btn btn-primary" href="" ng-click="updateEntry(oneEntry, 'redeploy');"><span class="icon icon-loop2"></span>&nbsp;Redeploy Service</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</tab>
	</tabset>
</section>
