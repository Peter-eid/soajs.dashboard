<section ng-controller="cdAppCtrl">
	<tabset>
		<tab heading="Configuration" ng-click="getRecipe()">
			<br>
			<ngform></ngform>
		</tab>
		<tab heading="ledger" ng-click="getLedger()">
			<br />
			<fieldset ng-show="imageLedger && imageLedger.length > 0">
				<legend>New Image Updates</legend>
				<div class="grid">
					<table width="100%">
						<thead>
							<tr>
								<th>ID</th>
								<th>Name</th>
								<th>Image</th>
								<th>Available Last Update</th>
								<th>Take Action</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="oneEntry in imageLedger" ng-class="{'first': $first, 'last': $last}" ng-class-odd="'odd'" ng-class-even="'even'" class="rows">
								<td>{{oneEntry.id}}</td>
								<td>{{oneEntry.name}}</td>
								<td>{{oneEntry.image.prefix}}/{{oneEntry.image.name}}:{{oneEntry.image.tag}}</td>
								<td>
									{{oneEntry.image.ts|fulldate}}
								</td>
								<td>
									<div class="dropdown serviceOpsDropdown">
										<button class="btn btn-default dropdown-toggle" type="button" id="serviceOps" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
											Service Operations
											<span class="caret"></span>
										</button>
										<ul class="dropdown-menu" aria-labelledby="serviceOps">
											<li><a href="" ng-click="updateEntry(oneEntry, 'redeploy');"><span class="icon icon-loop2"></span>&nbsp;Redeploy Service</a></li>
											<li><a href="" ng-click="updateEntry(oneEntry, 'rebuild');"><span class="icon icon-loop2"></span>&nbsp;Rebuild Service</a></li>
										</ul>
									</div>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
				<br>
			</fieldset>
			<fieldset ng-show="catalogLedger && catalogLedger.length > 0">
				<legend>New Catalog Updates</legend>
				<div class="grid">
					<table width="100%">
						<thead>
							<tr>
								<th>ID</th>
								<th>Name</th>
								<th>Catalog</th>
								<th>Current Version</th>
								<th>New Version</th>
								<th>Catalog Last Update</th>
								<th>Take Action</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="oneEntry in catalogLedger" ng-class="{'first': $first, 'last': $last}" ng-class-odd="'odd'" ng-class-even="'even'" class="rows">
								<td>{{oneEntry.id}}</td>
								<td>{{oneEntry.name}}</td>
								<td>{{oneEntry.catalog.name}}<em>&nbsp; ({{oneEntry.catalog.type}}<span ng-show="oneEntry.catalog.subtype">/{{oneEntry.catalog.subtype}}</span>)</em></td>
								<td>
									<span ng-show="oneEntry.labels['soajs.catalog.v']">Version {{oneEntry.labels['soajs.catalog.v']}}</span>
									<span ng-show="!oneEntry.labels['soajs.catalog.v']">N/A</span>
								</td>
								<td>{{oneEntry.catalog.v}}</td>
								<td>{{oneEntry.catalog.ts|fulldate}}</td>
								<td><a class="btn btn-default" href="" ng-click="updateEntry(oneEntry, 'rebuild');"><span class="icon icon-loop2"></span>&nbsp;Rebuild Service</a></td>
							</tr>
						</tbody>
					</table>
				</div>
				<br>
			</fieldset>
			<fieldset ng-show="codeLedger && codeLedger.length > 0">
				<legend>New Code Updates</legend>
				<div class="grid">
					<table width="100%">
						<thead>
							<tr>
								<th>ID</th>
								<th>Name</th>
								<th>Catalog</th>
								<th>Branch</th>
								<th>Code Last Update</th>
								<th>Take Action</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="oneEntry in codeLedger" ng-class="{'first': $first, 'last': $last}" ng-class-odd="'odd'" ng-class-even="'even'" class="rows">
								<td>{{oneEntry.id}}</td>
								<td>{{oneEntry.name}}</td>
								<td>{{oneEntry.catalog.name}}<em>&nbsp; ({{oneEntry.catalog.type}}<span ng-show="oneEntry.catalog.subtype">/{{oneEntry.catalog.subtype}}</span>)</em>&nbsp;
									<span ng-show="oneEntry.labels['soajs.catalog.v']">Version {{oneEntry.labels['soajs.catalog.v']}}</span>
									<span ng-show="!oneEntry.labels['soajs.catalog.v']">N/A</span>
								</td>
								<td>{{oneEntry.repo.branch}}</td>
								<td>{{oneEntry.repo.ts|fulldate}}</td>
								<td><a class="btn btn-default" href="" ng-click="updateEntry(oneEntry, 'redeploy');"><span class="icon icon-loop2"></span>&nbsp;Redeploy Service</a></td>
							</tr>
						</tbody>
					</table>
				</div>
			</fieldset>
		</tab>
	</tabset>
</section>
